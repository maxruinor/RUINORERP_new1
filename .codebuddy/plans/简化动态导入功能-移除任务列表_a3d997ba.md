---
name: 简化动态导入功能-移除任务列表
overview: 从UCBasicDataImport.cs中移除多步骤导入的任务列表和任务体系相关代码，简化为直接导入模式。
todos:
  - id: remove-task-fields
    content: 移除任务列表相关字段声明和初始化代码
    status: completed
  - id: simplify-execute-method
    content: 简化ExecuteDynamicImport方法，移除任务询问对话框
    status: completed
    dependencies:
      - remove-task-fields
  - id: remove-task-methods
    content: 删除AddToImportTask、ShowImportTaskList和ExecuteAllImportTasks方法
    status: completed
    dependencies:
      - simplify-execute-method
  - id: remove-task-classes
    content: 删除ImportTask类和TaskStatus枚举定义
    status: completed
    dependencies:
      - remove-task-methods
  - id: test-import-functionality
    content: 测试简化后的直接导入功能
    status: completed
    dependencies:
      - remove-task-classes
---

## 产品概述

简化动态导入功能，移除多步骤导入的任务列表和任务体系，改为直接导入模式，提升用户体验和操作效率。

## 核心功能

- 移除任务列表相关字段声明
- 移除任务询问对话框
- 移除添加到任务列表的方法
- 移除显示任务列表的方法
- 移除执行所有任务的方法
- 移除ImportTask类和TaskStatus枚举
- 简化导入流程为直接执行模式
- 保留单步导入的核心功能

## 技术栈

- 项目类型: Windows Forms应用程序 (C#)
- 数据访问: SqlSugar ORM
- 开发环境: .NET Framework

## 技术架构

### 修改范围

本次重构仅涉及 `UCBasicDataImport.cs` 单个文件，相关辅助类 `DynamicImporter.cs` 和 `DynamicDataValidator.cs` 无需修改。

### 代码删除清单

1. **字段声明删除**（第46-48行）

- `List<ImportTask> _importTasks`
- `int _currentTaskIndex`

2. **初始化代码删除**（第93-94行）

- 任务列表初始化代码

3. **任务询问对话框删除**（第1031-1040行）

- `ExecuteDynamicImport` 方法中的多步骤询问逻辑

4. **方法删除**

- `AddToImportTask()`（第1055-1089行）
- `ShowImportTaskList()`（第1247-1280行）
- `ExecuteAllImportTasks()`（第1285-1383行）

5. **类和枚举删除**（第1386-1449行）

- `ImportTask` 类
- `TaskStatus` 枚举

### 修改后的流程

用户点击"导入"按钮 → 直接执行 `ExecuteSingleImport()` 方法 → 完成导入并显示结果

## 实施细节

### 核心修改逻辑

**ExecuteDynamicImport方法简化**：

```
private void ExecuteDynamicImport()
{
    // 保留原有检查逻辑
    if (_selectedEntityType == null) { ... }
    if (_currentMappings == null || _currentMappings.Count == 0) { ... }
    if (_parsedImportData == null || _parsedImportData.Rows.Count == 0) { ... }

    // 直接执行导入，移除任务询问
    ExecuteSingleImport();
}
```

### 保留功能清单

- Excel文件解析
- 列映射配置
- 数据验证
- 单步导入执行
- 导入结果展示
- 映射配置管理