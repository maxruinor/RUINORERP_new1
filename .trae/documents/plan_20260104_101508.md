# 修复SpeechSynthesizer事件名称错误

## 问题分析

根据编译错误和.NET Framework文档，SpeechSynthesizer类没有`SpeakAsyncCompleted`事件，正确的事件名称是`SpeakCompleted`。同时，事件处理程序的参数类型也应该是`SpeakCompletedEventArgs`，而不是`SpeakAsyncCompletedEventArgs`。

## 修复方案

修改 `e:\CodeRepository\SynologyDrive\RUINORERP\RUINORERP.UI\Common\TaskVoiceReminder.cs` 文件，将所有错误的事件名称和事件处理程序参数更正：

1. 将 `SpeakAsyncCompleted` 事件改为 `SpeakCompleted`
2. 将 `SpeakAsyncCompletedEventArgs` 参数类型改为 `SpeakCompletedEventArgs`
3. 确保事件处理程序的签名正确

## 具体修改步骤

### 步骤1：修改事件绑定

将构造函数中的事件绑定从：
```csharp
_synthesizer.SpeakAsyncCompleted += Synthesizer_SpeakAsyncCompleted;
```

改为：
```csharp
_synthesizer.SpeakCompleted += Synthesizer_SpeakCompleted;
```

### 步骤2：修改事件处理程序签名

将事件处理程序从：
```csharp
private void Synthesizer_SpeakAsyncCompleted(object? sender, SpeakAsyncCompletedEventArgs e)
```

改为：
```csharp
private void Synthesizer_SpeakCompleted(object? sender, SpeakCompletedEventArgs e)
```

### 步骤3：修改事件取消订阅

将Dispose方法中的事件取消订阅从：
```csharp
_synthesizer.SpeakAsyncCompleted -= Synthesizer_SpeakAsyncCompleted;
```

改为：
```csharp
_synthesizer.SpeakCompleted -= Synthesizer_SpeakCompleted;
```

## 预期效果

通过以上修改，SpeechSynthesizer事件将能正确绑定和触发，编译错误将被解决。系统消息语音提醒功能将能正常工作，包括：

- 异步语音播放
- 消息队列管理
- 消息去重机制
- 支持多种消息类型

## 技术要点

- SpeechSynthesizer类的正确事件名称是SpeakCompleted
- 事件处理程序的参数类型是SpeakCompletedEventArgs
- 确保事件绑定和取消订阅使用相同的事件名称和处理程序
- 保持原有的异步播放逻辑不变

## 风险评估

- 修复仅涉及事件名称和参数类型的更改，不影响核心业务逻辑
- 修复后将解决编译错误，使系统消息语音提醒功能能正常工作
- 修复符合.NET Framework的标准API使用方式

通过以上修复，系统消息语音提醒功能将能正常编译和运行，为用户提供及时、准确的语音提醒服务。