# 销售订单

!!! info "功能说明"
    销售订单窗体用于创建和管理销售订单，是企业与客户之间的正式合同凭证。该窗体支持普通销售、平台订单、定制订单、外贸订单等多种业务场景。

## 📸 界面概览

![销售订单界面](../images/UCSaleOrder/main-interface.png)
*销售订单主界面（请添加实际截图）*

## 🎨 窗体布局

### 主信息区

<!-- 截图1：主信息区整体布局 -->
![主信息区](../images/UCSaleOrder/main-info-area.png)
*主信息区布局（请添加实际截图）*

- **客户信息**：客户、收款账户、业务员、项目组
- **订单信息**：订单编号、订单日期、平台订单号、客户PO号
- **交期信息**：预交期、运输方式、送货地址
- **财务信息**：币别、汇率、付款类型、付款状态
- **特殊选项**：平台单、定制订单
- **审批信息**：审批结果、审批意见

### 明细区（表格）

<!-- 截图2：明细表格区域 -->
![明细表格](../images/UCSaleOrder/detail-grid.png)
*订单明细表格（请添加实际截图）*

- 产品明细列表
- 数量、单价、金额、折扣
- 定制成本（定制订单）
- 税额、佣金

### 汇总区

<!-- 截图3：汇总信息区域 -->
![汇总区](../images/UCSaleOrder/summary-area.png)
*订单汇总信息（请添加实际截图）*

- 总数量、总成本、总金额
- 税额、佣金金额
- 外币金额（外贸订单）
- 订金、运费收入

### 明细区（表格）
- 产品明细列表
- 数量、单价、金额、折扣
- 定制成本（定制订单）
- 税额、佣金

### 汇总区
- 总数量、总成本、总金额
- 税额、佣金金额
- 外币金额（外贸订单）
- 订金、运费收入

## 📋 基本操作流程

### 新建订单

<!-- 截图4：新建订单操作流程 -->
![新建订单](../images/UCSaleOrder/create-order.png)
*新建订单操作（请添加实际截图）*

1. 点击工具栏 **新建** 按钮或按 `Ctrl + N`
2. 选择客户（`cmbCustomerVendor_ID`）
3. 选择币别（`cmbCurrency_ID`）
4. 添加订单明细
5. 保存订单（`Ctrl + S`）

!!! success "操作提示"
    按 `F1` 键可以在任意字段查看该字段的详细说明。

### 编辑订单

1. 在查询界面找到要编辑的订单
2. 双击打开订单
3. 修改订单信息
4. 保存订单

### 审核订单

<!-- 截图5：审核操作 -->
![审核订单](../images/UCSaleOrder/approve-order.png)
*审核订单操作（请添加实际截图）*

1. 打开订单
2. 检查订单信息是否正确
3. 点击 **审核** 按钮
4. 审核后订单将占用库存

!!! warning "注意事项"
    审核后的订单将占用库存，如果库存不足会提示错误。

### 取消审核

1. 打开已审核的订单
2. 点击 **取消审核** 按钮
3. 系统释放占用的库存

### 删除订单

1. 查询要删除的订单
2. 点击 **删除** 按钮
3. 确认删除操作
4. 删除后无法恢复

!!! danger "重要提醒"
    删除操作不可恢复！请确保订单确实需要删除。

## 💼 重要业务场景

### 场景1：创建平台订单

!!! example "业务场景"
    从电商平台（如淘宝、亚马逊、1688）接到的订单

<!-- 截图6：平台订单设置 -->
![平台订单](../images/UCSaleOrder/platform-order.png)
*平台订单设置（请添加实际截图）*

**操作步骤**：

1. 勾选 **平台单** 复选框（`chk平台单`）
2. 在 **平台订单号** 中填写平台订单号（`txtPlatformOrderNo`）
3. 在 **客户PO号** 中填写客户采购订单号（`txtCustomerPONo`）
4. 选择对应客户
5. 添加订单明细
6. 保存订单

**系统处理**：

- ✅ 平台订单不计入客户信用额度
- ✅ 出库后需要填写物流单号（`txtTrackNo`）
- ✅ 需要等待平台确认后才确认收入

!!! tip "提示"
    平台订单适用于电商平台接单场景，与普通订单在财务处理上有所不同。

### 场景2：创建定制订单

!!! example "业务场景"
    客户有特殊定制需求的订单

<!-- 截图7：定制订单设置 -->
![定制订单](../images/UCSaleOrder/customized-order.png)
*定制订单设置（请添加实际截图）*

**操作步骤**：

1. 勾选 **定制订单** 复选框（`chkIsCustomizedOrder`）
2. 在订单明细中填写 **定制成本**（`CustomizedCost`）
3. 在 **备注** 中详细描述定制要求（`txtNotes`）
4. 系统会自动生成生产工单
5. 保存订单

**定制成本说明**：

- 💰 定制成本是额外产生的成本，包括特殊材料、工时等
- 📊 系统会计算：产品基础成本 + 定制成本 = 总成本
- 📈 总成本影响毛利分析
- 🔒 定制成本不向客户展示

!!! note "说明"
    定制订单会自动触发生产流程，生成相应的生产工单。

### 场景3：创建外贸订单

!!! example "业务场景"
    向海外客户销售，使用外币结算

<!-- 截图8：外贸订单设置 -->
![外贸订单](../images/UCSaleOrder/foreign-order.png)
*外贸订单设置（请添加实际截图）*

**操作步骤**：

1. 选择外币币别（`cmbCurrency_ID`），如 USD
2. 系统自动显示当前汇率（`txtExchangeRate`）
3. 填写订单明细，数量和单价使用外币
4. 系统自动计算外币金额（`txtForeignTotalAmount`）
5. 保存订单

**汇率处理**：

| 情况 | 处理方式 |
|------|----------|
| 订单创建时 | 使用当前汇率 |
| 汇率变动后 | 不影响已创建订单 |
| 新订单 | 使用最新汇率 |
| 特殊情况 | 可以手动修改汇率 |

!!! info "汇率说明"
    系统每日自动更新汇率，您也可以手动维护汇率表。

### 场景4：部分收款订单

**业务场景**：订单需要预付部分款项

**操作步骤**：
1. 创建销售订单
2. 在"订金"字段填写预付金额（`txtDeposit`）
3. 系统自动记录收款状态
4. 保存订单
5. 出库后，剩余金额转为应收账款

**订金说明**：
- 订金是客户预付的款项
- 系统会生成预收款凭证
- 出库时自动核销订金
- 外币订单需要填写外币订金（`txtForeignDeposit`）

## 关键字段说明

### 客户相关字段

| 字段 | 控件 | 业务意义 | 使用场景 |
|-----|------|---------|---------|
| 客户 | `cmbCustomerVendor_ID` | 购买产品的客户 | 所有订单必填 |
| 收款账户 | `cmbAccount_id` | 订金和尾款收款账户 | 需要预付款时 |
| 业务员 | `cmbEmployee_ID` | 负责该订单的业务员 | 计算佣金、业绩统计 |
| 项目组 | `cmbProjectGroup` | 订单归属的项目组 | 项目管理、成本核算 |

### 订单信息字段

| 字段 | 控件 | 业务意义 | 使用场景 |
|-----|------|---------|---------|
| 订单编号 | `txtOrderNo` | 订单唯一标识 | 系统自动生成，不可修改 |
| 订单日期 | `dtpSaleDate` | 订单创建日期 | 系统默认当天，可修改 |
| 平台订单号 | `txtPlatformOrderNo` | 电商平台订单号 | 平台订单必填 |
| 客户PO号 | `txtCustomerPONo` | 客户采购订单号 | 客户有PO号时填写 |

### 交期信息字段

| 字段 | 控件 | 业务意义 | 使用场景 |
|-----|------|---------|---------|
| 预交期 | `dtpPreDeliveryDate` | 承诺给客户的交货日期 | 生产排产、交期跟踪 |
| 运输方式 | `txtshippingWay` | 产品运输方式 | 物流安排、运费计算 |
| 送货地址 | `txtShippingAddress` | 产品送货地址 | 物流发货、发票开具 |

### 财务信息字段

| 字段 | 控件 | 业务意义 | 使用场景 |
|-----|------|---------|---------|
| 币别 | `cmbCurrency_ID` | 结算货币 | 外贸订单选择外币 |
| 汇率 | `txtExchangeRate` | 外币对本币的汇率 | 外贸订单必填 |
| 付款类型 | `cmbPaytype_ID` | 付款方式 | 现金、银行转账、承兑汇票等 |
| 付款状态 | `cmbPayStatus` | 订单付款状态 | 系统自动更新 |

### 特殊选项字段

| 字段 | 控件 | 业务意义 | 使用场景 |
|-----|------|---------|---------|
| 平台单 | `chk平台单` | 是否为平台订单 | 平台订单勾选 |
| 定制订单 | `chkIsCustomizedOrder` | 是否为定制订单 | 定制订单勾选 |

### 费用字段

| 字段 | 控件 | 业务意义 | 使用场景 |
|-----|------|---------|---------|
| 运费收入 | `txtFreightIncome` | 向客户收取的运费 | 需要收运费时 |
| 运费收入外币 | `txtForeignFreightIncome` | 外币运费 | 外贸订单使用 |
| 订金 | `txtDeposit` | 客户预付款金额 | 需要预付款时 |
| 订金外币 | `txtForeignDeposit` | 外币订金 | 外贸订单使用 |
| 佣金金额 | `txtTotalCommissionAmount` | 业务员佣金总额 | 系统自动计算 |

## 订单明细表格

### 添加产品明细

1. 点击明细表格中的"新增"按钮
2. 选择产品
3. 输入数量
4. 系统自动填入单价、金额

### 修改产品明细

1. 在表格中双击要修改的行
2. 修改数量、单价等信息
3. 点击"确定"保存修改

### 删除产品明细

1. 选中要删除的行
2. 点击"删除"按钮
3. 确认删除操作

### 定制成本

**适用场景**：定制订单

**说明**：
- 定制成本是产品成本之外的特殊成本
- 包括：特殊材料成本、额外工时成本、设计费用等
- 定制成本不向客户展示
- 系统计算：产品成本 + 定制成本 = 总成本

**操作**：
1. 在明细表格中打开产品明细编辑窗口
2. 在"定制成本"字段填写金额
3. 保存明细

## 状态流转

### 订单状态

| 状态 | 说明 | 可执行操作 |
|-----|------|-----------|
| 新建 | 订单刚创建，未审核 | 编辑、审核、删除 |
| 已审核 | 订单已审核，占用库存 | 取消审核、出库、变更 |
| 部分出库 | 订单已部分出库 | 继续出库、变更 |
| 已出库 | 订单全部出库 | 查询、打印 |
| 已完成 | 订单已全部收款 | 查询、打印 |
| 已取消 | 订单已取消 | 查询（不可编辑） |

### 付款状态

| 状态 | 说明 |
|-----|------|
| 未付款 | 订单未收到任何款项 |
| 部分付款 | 订单收到部分款项（如订金） |
| 已付款 | 订单已全额付款 |

## 常见业务问题

### Q1: 订单审核后还能修改吗？

A: 已审核的订单不能直接修改，需要先取消审核。建议使用"订单变更"功能，这样可以保留变更历史记录。

### Q2: 订单可以部分出库吗？

A: 可以。在出库单中录入实际出库数量，系统会自动更新订单状态为"部分出库"，剩余数量可以后续出库。

### Q3: 如何处理客户要求修改订单？

A: 使用"订单变更"功能：
1. 打开原订单
2. 点击"变更"按钮
3. 修改订单内容
4. 系统自动记录变更日志
5. 需要重新审批

### Q4: 平台订单与普通订单有什么区别？

A: 主要区别：
- 平台订单需要填写平台订单号
- 平台订单不计入客户信用额度
- 需要填写物流单号
- 需要等待平台确认

### Q5: 如何查询某个客户的订单历史？

A:
1. 打开订单查询界面
2. 在"客户"下拉框中选择客户
3. 点击"查询"按钮
4. 显示该客户的所有订单

## 打印功能

### 打印订单

1. 打开订单
2. 点击工具栏"打印"按钮
3. 选择打印模板
4. 预览打印效果
5. 确认打印

### 导出订单

1. 打开订单查询界面
2. 选择要导出的订单
3. 点击"导出"按钮
4. 选择导出格式（Excel、PDF）
5. 保存文件

## 快捷键

| 快捷键 | 功能 |
|-------|------|
| F1 | 显示帮助 |
| F5 | 刷新数据 |
| Ctrl+N | 新建订单 |
| Ctrl+S | 保存订单 |
| Ctrl+F | 打开查询界面 |
| Ctrl+E | 编辑订单 |
| Ctrl+D | 删除订单 |
| Alt+A | 审核订单 |
| Alt+C | 取消审核 |
| Ctrl+P | 打印订单 |

## 注意事项

1. **客户信用控制**：订单金额超过客户信用额度时，系统会提示并阻止保存
2. **库存检查**：订单明细数量超过可用库存时，系统会提示
3. **价格控制**：修改单价超过浮动范围时，系统会要求审批
4. **交期控制**：预交期早于生产周期时，系统会提示
5. **数据保存**：离开窗体前请确保已保存数据，否则修改会丢失

## 📚 相关帮助

<div class="grid cards" markdown>

-   :material-warehouse: __销售出库单__

    ---

    了解如何从销售订单生成出库单

    [:octicons-arrow-right-24: 查看详情](./UCSaleOut.md)

-   :material-keyboard-return: __销售退货单__

    ---

    处理客户退货业务

    [:octicons-arrow-right-24: 查看详情](./UCSaleReturn.md)

-   :material-cash-register: __应收账款__

    ---

    管理销售订单产生的应收款项

    [:octicons-arrow-right-24: 查看详情](./ARReceivable.md)

-   :material-chart-line: __销售管理模块__

    ---

    了解销售管理的整体业务流程

    [:octicons-arrow-right-24: 查看详情](../modules/sales/index.md)

</div>

---

*最后更新：2024年1月*  
*文档版本：v1.0.0*
