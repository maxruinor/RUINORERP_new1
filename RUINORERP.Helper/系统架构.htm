<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RUINOR ERP系统架构</title>
    <style>
        body { font-family: "Microsoft YaHei", Arial, sans-serif; line-height: 1.6; margin: 20px; }
        h1 { color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 10px; }
        h2 { color: #2980b9; margin-top: 30px; }
        h3 { color: #16a085; }
        .architecture { background: #f5f5f5; padding: 20px; border-radius: 8px; margin: 15px 0; }
        .layer { background: #e8f4f8; padding: 15px; margin: 10px 0; border-left: 4px solid #3498db; }
        .tech-stack { display: flex; flex-wrap: wrap; gap: 10px; margin: 15px 0; }
        .tech-item { background: #3498db; color: white; padding: 8px 15px; border-radius: 20px; font-size: 14px; }
        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        th { background-color: #f2f2f2; }
        .highlight { background: #e8f4f8; padding: 10px; border-radius: 5px; margin: 10px 0; }
    </style>
</head>
<body>

<h1>RUINOR ERP 系统架构设计</h1>

<div class="architecture">
    <h2>整体架构概览</h2>
    <p>RUINOR ERP采用分层架构设计，遵循高内聚低耦合的原则，确保系统的可维护性、可扩展性和高性能。</p>
</div>

<h2>架构分层设计</h2>

<div class="layer">
    <h3>1. 表示层 (Presentation Layer)</h3>
    <p><strong>技术实现：</strong>Windows Forms桌面应用程序</p>
    <p><strong>主要职责：</strong></p>
    <ul>
        <li>用户界面展示和交互</li>
        <li>数据输入验证</li>
        <li>界面状态管理</li>
        <li>客户端缓存管理</li>
    </ul>
    <p><strong>核心组件：</strong>RUINORERP.UI项目</p>
</div>

<div class="layer">
    <h3>2. 业务逻辑层 (Business Logic Layer)</h3>
    <p><strong>技术实现：</strong>C#业务控制器和业务服务</p>
    <p><strong>主要职责：</strong></p>
    <ul>
        <li>业务规则验证</li>
        <li>业务流程控制</li>
        <li>数据转换和计算</li>
        <li>事务管理</li>
    </ul>
    <p><strong>核心组件：</strong>RUINORERP.Business项目（包含300+业务控制器）</p>
</div>

<div class="layer">
    <h3>3. 数据访问层 (Data Access Layer)</h3>
    <p><strong>技术实现：</strong>SqlSugar ORM框架</p>
    <p><strong>主要职责：</strong></p>
    <ul>
        <li>数据库连接管理</li>
        <li>数据持久化操作</li>
        <li>SQL语句生成和执行</li>
        <li>数据缓存管理</li>
    </ul>
    <p><strong>核心组件：</strong>SqlSugar ORM集成</p>
</div>

<div class="layer">
    <h3>4. 服务层 (Service Layer)</h3>
    <p><strong>技术实现：</strong>Windows服务 + SuperSocket通信框架</p>
    <p><strong>主要职责：</strong></p>
    <ul>
        <li>网络通信管理</li>
        <li>实时消息推送</li>
        <li>分布式缓存同步</li>
        <li>文件传输服务</li>
    </ul>
    <p><strong>核心组件：</strong>RUINORERP.Server项目</p>
</div>

<h2>技术栈</h2>
<div class="tech-stack">
    <div class="tech-item">.NET Framework</div>
    <div class="tech-item">C#</div>
    <div class="tech-item">Windows Forms</div>
    <div class="tech-item">SuperSocket</div>
    <div class="tech-item">SqlSugar ORM</div>
    <div class="tech-item">Autofac DI</div>
    <div class="tech-item">CacheManager</div>
    <div class="tech-item">WorkflowCore</div>
</div>

<h2>核心架构组件</h2>

<table>
    <tr>
        <th>组件名称</th>
        <th>功能描述</th>
        <th>技术实现</th>
    </tr>
    <tr>
        <td>BaseControllerGeneric</td>
        <td>通用业务控制器基类，提供CRUD操作和权限验证</td>
        <td>C#泛型设计模式</td>
    </tr>
    <tr>
        <td>SmartReminderService</td>
        <td>智能提醒服务，支持安全库存预警和任务到期提醒</td>
        <td>定时任务 + 条件判断</td>
    </tr>
    <tr>
        <td>ApprovalWorkflow</td>
        <td>审批工作流引擎，支持多级审批和条件审批</td>
        <td>WorkflowCore工作流引擎</td>
    </tr>
    <tr>
        <td>CacheSyncManager</td>
        <td>缓存同步管理器，实现分布式缓存数据一致性</td>
        <td>发布/订阅模式</td>
    </tr>
    <tr>
        <td>FileTransferService</td>
        <td>文件传输服务，支持大文件分块传输</td>
        <td>SuperSocket文件传输协议</td>
    </tr>
</table>

<h2>数据架构设计</h2>

<div class="highlight">
    <h3>数据库设计原则</h3>
    <ul>
        <li><strong>规范化设计：</strong>遵循数据库第三范式，减少数据冗余</li>
        <li><strong>性能优化：</strong>合理使用索引和分区技术</li>
        <li><strong>扩展性：</strong>支持水平扩展和垂直扩展</li>
        <li><strong>安全性：</strong>数据加密和访问控制</li>
    </ul>
</div>

<h3>核心数据表结构</h3>
<table>
    <tr>
        <th>表名</th>
        <th>功能描述</th>
        <th>关键字段</th>
    </tr>
    <tr>
        <td>tb_BOM_S</td>
        <td>标准物料清单(BOM)主表</td>
        <td>BOMID, ProductID, Version, Status</td>
    </tr>
    <tr>
        <td>tb_SaleOrder</td>
        <td>销售订单主表</td>
        <td>OrderID, CustomerID, OrderDate, TotalAmount</td>
    </tr>
    <tr>
        <td>tb_PurOrder</td>
        <td>采购订单主表</td>
        <td>PurOrderID, SupplierID, OrderDate, Status</td>
    </tr>
    <tr>
        <td>tb_Inventory</td>
        <td>库存管理表</td>
        <td>InventoryID, ProductID, WarehouseID, Quantity</td>
    </tr>
    <tr>
        <td>tb_Approval</td>
        <td>审批流程表</td>
        <td>ApprovalID, BusinessID, ApproverID, Status</td>
    </tr>
</table>

<h2>部署架构</h2>

<div class="highlight">
    <h3>服务器端部署</h3>
    <ul>
        <li><strong>部署方式：</strong>Windows服务形式运行</li>
        <li><strong>支持模式：</strong>单机部署、集群部署</li>
        <li><strong>负载均衡：</strong>支持多实例负载均衡</li>
        <li><strong>数据库：</strong>独立数据库服务器部署</li>
    </ul>
</div>

<div class="highlight">
    <h3>客户端部署</h3>
    <ul>
        <li><strong>部署方式：</strong>Windows桌面应用程序</li>
        <li><strong>更新机制：</strong>支持自动更新</li>
        <li><strong>配置管理：</strong>XML配置文件管理连接信息</li>
        <li><strong>兼容性：</strong>支持Windows 7及以上版本</li>
    </ul>
</div>

<h2>安全架构</h2>

<div class="layer">
    <h3>身份认证机制</h3>
    <ul>
        <li><strong>用户认证：</strong>基于用户名密码的身份验证</li>
        <li><strong>会话管理：</strong>基于Token的会话管理机制</li>
        <li><strong>单点登录：</strong>支持多客户端单点登录</li>
    </ul>
</div>

<div class="layer">
    <h3>权限控制机制</h3>
    <ul>
        <li><strong>RBAC模型：</strong>基于角色的访问控制</li>
        <li><strong>数据权限：</strong>支持行级数据权限控制</li>
        <li><strong>功能权限：</strong>细粒度的功能权限控制</li>
    </ul>
</div>

<div class="layer">
    <h3>数据安全机制</h3>
    <ul>
        <li><strong>数据传输：</strong>SSL/TLS加密传输</li>
        <li><strong>数据存储：</strong>敏感数据加密存储</li>
        <li><strong>审计日志：</strong>完整的操作审计日志</li>
    </ul>
</div>

<h2>性能优化策略</h2>

<table>
    <tr>
        <th>优化领域</th>
        <th>优化策略</th>
        <th>实现效果</th>
    </tr>
    <tr>
        <td>数据库性能</td>
        <td>索引优化、查询优化、连接池</td>
        <td>提升数据库响应速度</td>
    </tr>
    <tr>
        <td>缓存策略</td>
        <td>多级缓存、分布式缓存</td>
        <td>减少数据库访问压力</td>
    </tr>
    <tr>
        <td>网络通信</td>
        <td>连接复用、数据压缩</td>
        <td>提升网络传输效率</td>
    </tr>
    <tr>
        <td>内存管理</td>
        <td>对象池、垃圾回收优化</td>
        <td>减少内存占用</td>
    </tr>
</table>

<div class="highlight">
    <p><strong>架构优势：</strong>通过合理的架构设计，RUINOR ERP系统具备高可用性、高可扩展性和高性能的特点，能够满足企业级应用的需求。</p>
</div>

</body>
</html>