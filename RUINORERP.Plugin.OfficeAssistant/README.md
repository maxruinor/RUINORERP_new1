# Office Assistant Plugin

办公助手插件是一个用于对比Excel文件的工具，可以帮助用户快速识别两个Excel文件之间的差异。

## 功能特性

1. **Excel文件加载** - 支持加载.xlsx和.xls格式的Excel文件
2. **工作表选择** - 支持选择具体的工作表进行对比
3. **数据预览** - 预览加载的Excel文件的前10行数据
4. **列映射配置** - 可以配置键列和比较列的映射关系
5. **文件对比** - 对比两个Excel文件，识别新增、删除和修改的记录
6. **结果展示** - 使用不同颜色标识不同类型的差异记录
7. **结果导出** - 将对比结果导出到Excel文件
8. **配置保存** - 自动保存用户配置，支持自动加载文件

## 使用说明

### 1. 加载文件
- 点击"选择旧文件"和"选择新文件"按钮选择要对比的Excel文件
- 或者直接将文件拖拽到对应的文本框中
- 点击"加载文件"按钮加载文件数据

### 2. 配置工作表
- 从下拉列表中选择要对比的工作表

### 3. 配置列映射
- 在左侧列表中选择旧文件和新文件的列
- 点击"添加键列"按钮将选中的列作为键列
- 点击"添加比较列"按钮将选中的列作为比较列

### 4. 执行对比
- 点击"开始对比"按钮执行对比操作
- 系统会显示对比结果的摘要信息
- 可以选择查看详细结果

### 5. 导出结果
- 点击"导出结果"按钮将对比结果导出到Excel文件

## 技术实现

### 核心组件
- **ExcelHelper** - Excel文件读取和处理
- **ComparisonEngine** - Excel文件对比引擎
- **ComparisonResultExporter** - 对比结果导出器
- **ComparisonResultForm** - 对比结果展示窗体

### 第三方库
- **ClosedXML** - 用于Excel文件的读取和写入

## 注意事项

1. Excel文件的第一行必须包含列标题
2. 空白的列标题会被自动命名为"未命名列X"
3. 确保选择的键列能够唯一标识每一条记录
4. 对比时可以选择是否区分大小写和忽略空格

## 常见问题

### 1. 加载文件时提示"Excel文件中存在空白列标题"
解决方法：请检查Excel文件，确保所有列都有标题。

### 2. 对比结果不正确
解决方法：请检查键列配置是否正确，键列应该能够唯一标识每一条记录。

### 3. 如何选择合适的键列？
键列应该是能够唯一标识每条记录的列，例如ID列、编号列，或者多个列的组合。