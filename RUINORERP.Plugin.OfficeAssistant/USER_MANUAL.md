# Excel 对比工具用户手册

## 简介

Excel 对比工具是一个专门用于对比两个 Excel 文件差异的工具，可以帮助用户快速识别两个文件之间的新增、删除和修改记录。

## 系统要求

- Windows 操作系统
- .NET Framework 4.8 或更高版本
- 支持的 Excel 文件格式：.xlsx, .xls

## 功能特性

### 1. 基础对比功能

#### 文件选择
- 支持通过文件选择对话框选择两个 Excel 文件
- 支持拖拽文件到文本框中
- 支持自动加载上次使用的文件

#### 工作表选择
- 自动识别 Excel 文件中的所有工作表
- 支持为两个文件分别选择工作表

#### 列映射配置
- 动态显示两个文件的列名
- 支持配置键列映射关系
- 支持配置比较列映射关系
- 提供自动匹配功能

#### 唯一键设置
- 支持单列作为唯一键
- 支持多列组合作为唯一键

### 2. 对比模式

#### 存在性对比
- 识别在旧文件中有但新文件中没有的记录（删除记录）
- 识别在新文件中有但旧文件中没有的记录（新增记录）

#### 数据差异对比
- 对于具有相同键值的记录，对比其他列的数据差异
- 支持区分大小写和忽略空格选项

#### 自定义列对比
- 允许用户指定特定列进行对比
- 可以只对比关心的列，忽略其他列

### 3. 结果展示

#### 差异高亮显示
- 新增记录用绿色背景标识
- 删除记录用红色背景标识
- 修改记录用黄色背景标识

#### 分类查看
- 在不同的标签页中分别展示新增、删除和修改的记录
- 提供清晰的分类视图

#### 详细信息
- 显示具体的差异字段和数值
- 显示旧值和新值的对比

### 4. 其他功能

#### 结果导出
- 将对比结果导出到 Excel 文件
- 保持原有的分类和格式

#### 配置保存
- 自动保存用户的配置选项
- 下次启动时自动加载配置

## 使用指南

### 1. 加载文件

1. 点击"选择旧文件"按钮选择第一个 Excel 文件
2. 点击"选择新文件"按钮选择第二个 Excel 文件
3. 点击"加载文件"按钮加载文件数据

或者直接将文件拖拽到对应的文本框中。

### 2. 配置工作表

1. 从下拉列表中选择旧文件的工作表
2. 从下拉列表中选择新文件的工作表

### 3. 配置列映射

1. 在左侧列列表中选择旧文件的列
2. 在右侧列列表中选择新文件的列
3. 点击"添加键列"按钮设置键列映射
4. 点击"添加比较列"按钮设置比较列映射

### 4. 设置对比选项

1. 选择是否区分大小写
2. 选择是否忽略空格
3. 选择对比模式

### 5. 执行对比

1. 点击"开始对比"按钮
2. 查看对比结果摘要
3. 选择是否查看详细结果

### 6. 查看详细结果

1. 在详细结果窗口中查看分类的差异记录
2. 切换标签页查看新增、删除和修改的记录

### 7. 导出结果

1. 点击"导出结果"按钮
2. 选择保存位置和文件名
3. 确认导出

## 常见问题

### 1. 为什么需要设置键列？

键列用于唯一标识每一条记录，是进行对比的基础。没有键列，工具无法确定两条记录是否代表同一个实体。

### 2. 如何选择合适的键列？

键列应该是能够唯一标识每条记录的列，例如：
- ID列
- 编号列
- 组合键（多个列的组合）

### 3. 对比结果不准确怎么办？

请检查以下几点：
- 键列设置是否正确
- 工作表选择是否正确
- 文件是否损坏
- 是否存在重复的键值

### 4. 支持哪些Excel文件格式？

支持 .xlsx 和 .xls 格式的 Excel 文件。

## 技术支持

如有任何问题，请联系技术支持团队。

## 版本历史

### 1.0.0.0
- 初始版本
- 实现基础对比功能
- 支持文件加载、列映射、对比执行和结果展示