# 帮助内容编辑指南

## ✅ 系统已配置完成

帮助系统已配置为**混合模式**：
- **开发环境**: 从 `HelpContent/` 文件夹加载帮助内容
- **发布环境**: 从嵌入资源（程序集内部）加载帮助内容

## 📝 你只需要做的

### 1. 编辑帮助文件

在 `RUINORERP.UI/HelpContent/` 目录下创建和编辑 `.md` 文件：

```
RUINORERP.UI/
└── HelpContent/
    ├── Modules/          # 模块级帮助
    │   ├── SalesManagement.md
    │   └── InventoryManagement.md
    ├── Forms/            # 窗体级帮助
    │   ├── UCSaleOrder.md
    │   └── UCPurchaseOrder.md
    └── Fields/          # 字段级帮助
        ├── tb_SaleOrder/
        │   ├── CustomerID.md
        │   ├── OrderDate.md
        │   └── DeliveryDate.md
        └── tb_Product/
            └── ProductName.md
```

### 2. 文件命名规则

| 类型 | 命名规则 | 示例 |
|-----|---------|------|
| 窗体帮助 | `{窗体类名}.md` | `UCSaleOrder.md` |
| 字段帮助 | `{字段名}.md` | `CustomerID.md` |
| 模块帮助 | `{模块名}.md` | `SalesManagement.md` |

### 3. 帮助键自动映射

系统会自动将文件路径映射为帮助键：

```
文件路径: HelpContent/Forms/UCSaleOrder.md
          ↓
帮助键:   Forms.UCSaleOrder

文件路径: HelpContent/Fields/tb_SaleOrder/CustomerID.md
          ↓
帮助键:   Fields.tb_SaleOrder.CustomerID
```

## 📄 帮助文件模板

### 窗体级帮助模板

```markdown
# 窗体名称

## 功能说明
简要描述该窗体的主要功能和用途。

## 使用步骤
1. 第一步操作
2. 第二步操作
3. 第三步操作

## 注意事项
- 重要事项1
- 重要事项2

## 快捷键
- F1: 显示帮助
- Ctrl+S: 保存
- Esc: 关闭窗体

## 相关功能
- [相关窗体1](#)
- [相关窗体2](#)
```

### 字段级帮助模板

```markdown
# 字段名称

## 字段说明
简要描述该字段的含义和作用。

## 数据类型
- 类型: [文本/数字/日期等]
- 长度: [最大长度限制]
- 必填: [是/否]

## 取值范围
- 最小值: xxx
- 最大值: xxx
- 默认值: xxx

## 使用示例
```
示例值1
示例值2
```

## 注意事项
- 注意事项1
- 注意事项2
```

## 🎯 在代码中使用

### 方式1: 自动匹配（推荐）

控件名称会自动匹配帮助文件：

```csharp
// 控件名: txtCustomerID
// 自动匹配: Fields/tb_SaleOrder/CustomerID.md
public UCSaleOrder()
{
    InitializeComponent();

    // 只需设置窗体帮助键
    FormHelpKey = "UCSaleOrder";
}
```

### 方式2: 手动指定帮助键

```csharp
public UCSaleOrder()
{
    InitializeComponent();

    // 手动指定控件帮助键
    txtCustomerID.SetHelpKey("tb_SaleOrder.CustomerID");
}
```

### 方式3: 使用扩展方法

```csharp
// 设置窗体帮助页
this.SetHelpPage("Forms/UCSaleOrder", "销售订单帮助");

// 设置控件帮助键
txtCustomerID.SetControlHelpKey("tb_SaleOrder.CustomerID");
```

## 🔍 测试帮助系统

### 1. 启用帮助

```csharp
public UCSaleOrder()
{
    InitializeComponent();

    // 确保帮助系统已启用
    EnableSmartHelp = true;
}
```

### 2. 测试方式

#### 方式A: F1键测试
1. 运行程序
2. 打开销售订单窗体
3. 将光标放在任意控件上
4. 按 `F1` 键
5. 应该显示对应的帮助内容

#### 方式B: 鼠标悬停测试
1. 将鼠标悬停在控件上约500毫秒
2. 应该显示简短的智能提示

#### 方式C: 帮助按钮
1. 如果有帮助按钮，点击它
2. 应该显示详细帮助面板

## 🚀 发布流程

1. **编辑帮助内容**: 在 `HelpContent/` 目录下编写/修改 `.md` 文件
2. **测试效果**: 按 `F1` 测试帮助是否正常显示
3. **编译项目**: `dotnet build` 或 `Ctrl+Shift+B`
4. **发布程序**: 帮助内容会自动嵌入到 `RUINORERP.UI.dll` 中

## ⚠️ 常见问题

### Q: 修改了帮助文件，但没生效？

**A**: 混合模式优先从文件系统加载，确保：
1. 修改的文件在 `HelpContent/` 目录下
2. 文件路径正确
3. 重新启动程序

### Q: 发布后帮助内容丢失？

**A**: 确保编译时将帮助文件嵌入到程序集：
```xml
<EmbeddedResource Include="HelpContent\**\*.*">
  <CopyToOutputDirectory>Never</CopyToOutputDirectory>
</EmbeddedResource>
```

### Q: 帮助键找不到对应的帮助文件？

**A**: 检查：
1. 帮助文件命名是否正确
2. 路径结构是否匹配
3. 文件扩展名是否为 `.md`

### Q: 如何查看所有已注册的帮助？

**A**: 调用统计方法：
```csharp
int count = HelpManager.Instance.GetHelpCount();
MessageBox.Show($"当前帮助数量: {count}");
```

## 📚 完整示例

### 销售订单窗体帮助系统

```
HelpContent/
├── Forms/
│   └── UCSaleOrder.md          # 销售订单窗体帮助
└── Fields/
    └── tb_SaleOrder/
        ├── CustomerID.md       # 客户字段帮助
        ├── OrderNo.md         # 订单编号帮助
        ├── OrderDate.md       # 订单日期帮助
        └── DeliveryDate.md    # 交货日期帮助
```

### 代码集成

```csharp
public partial class UCSaleOrder : BaseEditGeneric<tb_SaleOrder>
{
    public UCSaleOrder()
    {
        InitializeComponent();

        // 设置窗体帮助键
        FormHelpKey = "UCSaleOrder";
    }
}
```

### 测试步骤

1. 启动程序，打开销售订单窗体
2. 将光标放在"客户"输入框上
3. 按 `F1` 键
4. 应该显示 `HelpContent/Fields/tb_SaleOrder/CustomerID.md` 的内容

## 🎓 最佳实践

1. **使用Markdown格式**: 轻量级，易于编写和维护
2. **保持结构清晰**: 使用标题、列表、表格等组织内容
3. **添加截图**: 使用相对路径引用图片资源
4. **提供示例**: 给出具体的使用示例和场景
5. **定期更新**: 随功能变化及时更新帮助内容

## 📞 技术支持

如遇问题，请检查：
1. `HelpSystem/帮助资源配置完成总结.md` - 配置详情
2. `HelpSystem/销售订单帮助系统完整示例.md` - 完整示例
3. `LocalHelpProvider.cs` - 核心实现

---

**注意**: 开发时直接编辑 `HelpContent/` 下的 `.md` 文件即可，无需手动配置资源文件。编译时会自动嵌入。
