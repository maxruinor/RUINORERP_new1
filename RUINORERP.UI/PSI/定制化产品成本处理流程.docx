# 定制化产品成本处理流程

## 1. 业务背景与目标

### 1.1 标准SKU产品与低频率定制性产品的成本处理差异

标准SKU产品是指企业常规生产或销售的、具有固定规格和成本结构的产品。这类产品通常有完整的BOM（物料清单）配方，成本计算相对固定。

低频率定制性产品是指根据客户特殊需求偶尔生产或销售的产品，这类产品具有以下特点：
- 生产频率低，可能是一次性或小批量生产
- 规格、配置或工艺要求与标准产品有差异
- 如果为每个定制产品创建独立的SKU和BOM，会导致SKU数量激增，管理复杂度大幅提高
- 传统的成本核算方式难以适应这类产品的灵活性需求

### 1.2 定制成本列设计的目的

定制成本列的设计旨在：
- **避免为低频定制产品创建大量SKU及BOM配方**：通过在现有SKU基础上添加定制成本列，无需为每个定制需求创建新的SKU和BOM，显著减少系统中的数据量
- **简化操作流程**：业务人员可以直接在采购订单或销售订单中录入定制成本，无需复杂的SKU和BOM维护
- **提高数据准确性**：确保定制产品的成本能够准确反映实际情况，避免成本核算偏差
- **保持系统灵活性**：在不破坏现有标准成本核算体系的前提下，为定制产品提供灵活的成本处理方式

## 2. 功能设计说明

### 2.1 采购订单与销售订单中"定制成本"列的添加位置与使用方式

#### 采购订单
- **添加位置**：采购订单明细行中，在标准单价列旁边添加"定制成本"列
- **使用方式**：
  - 当采购的产品为定制产品时，勾选"定制单"复选框
  - 在"定制成本"列中录入该定制产品的实际成本
  - 系统自动计算总成本 = 数量 × 定制成本

#### 销售订单
- **添加位置**：销售订单明细行中，在标准单价列旁边添加"定制成本"列
- **使用方式**：
  - 当销售的产品为定制产品时，勾选"定制单"复选框
  - 在"定制成本"列中录入该定制产品的实际成本
  - 系统自动计算总成本 = 数量 × 定制成本

### 2.2 采购入库单和销售出库单中成本列的体现形式及数据来源

#### 采购入库单
- **体现形式**：采购入库单明细行中显示"定制成本"列
- **数据来源**：从采购订单的"定制成本"列继承，不允许修改
- **显示要求**：如果是定制产品，显示采购订单中录入的定制成本；如果是非定制产品，该列显示为空或不显示

#### 销售出库单
- **体现形式**：销售出库单明细行中显示"定制成本"列
- **数据来源**：从销售订单的"定制成本"列继承，不允许修改
- **显示要求**：如果是定制产品，显示销售订单中录入的定制成本；如果是非定制产品，该列显示为空或不显示

### 2.3 定制成本列在单据明细中的录入规则与显示要求

#### 录入规则
- 只有勾选"定制单"复选框后，"定制成本"列才允许录入
- "定制成本"必须大于0
- 录入定制成本后，系统自动更新相关金额字段

#### 显示要求
- 在单据明细列表中，"定制成本"列应与标准单价列并列显示
- 对于定制产品，应在列表中通过特殊标记（如"[定制]"）进行标识
- 在打印单据时，应包含"定制成本"列的信息

## 3. 数据处理机制

### 3.1 定制成本数据的独立保存方式及其与标准SKU成本的区别

- **独立保存方式**：定制成本作为单独的字段保存在单据明细的扩展属性中，不修改产品主数据中的标准成本
- **与标准SKU成本的区别**：
  - 标准SKU成本：保存在产品主数据中，适用于所有非定制场景
  - 定制成本：仅与特定单据关联，只影响该单据的成本计算

### 3.2 定制成本如何确保财务模块支付金额计算的准确性

- **采购方向**：财务模块在计算付款金额时，对于定制产品，使用采购订单中的定制成本进行计算，确保支付金额与实际成本一致
- **销售方向**：财务模块在计算收款金额时，使用销售订单中的销售价格进行计算，不受定制成本影响

### 3.3 定制成本如何不影响库存中的标准成本金额

- 定制成本仅作为单据级别的临时成本，不更新库存中的标准成本
- 库存模块仍使用标准SKU的成本进行库存价值计算
- 定制成本与标准成本在数据存储上完全分离，互不影响

## 4. 业务流程说明

### 4.1 采购方向：定制成本的录入、保存及对财务付款金额的影响机制

1. **采购订单创建**：
   - 选择产品SKU
   - 勾选"定制单"复选框
   - 录入定制成本
   - 系统自动计算总成本

2. **采购入库**：
   - 根据采购订单生成采购入库单
   - 定制成本从采购订单继承，不允许修改
   - 系统记录入库数量和定制成本

3. **财务付款**：
   - 财务模块根据采购入库单中的定制成本计算应付金额
   - 确保付款金额与实际定制成本一致

### 4.2 销售方向：定制成本在销售数据汇总统计中的处理方式

1. **销售订单创建**：
   - 选择产品SKU
   - 勾选"定制单"复选框
   - 录入定制成本
   - 系统自动计算总成本

2. **销售出库**：
   - 根据销售订单生成销售出库单
   - 定制成本从销售订单继承，不允许修改
   - 系统记录出库数量和定制成本

3. **销售数据汇总**：
   - 在销售数据汇总统计中，区分标准SKU和定制产品
   - 对于定制产品，使用定制成本进行统计
   - 确保销售数据统计的准确性

### 4.3 毛利润计算逻辑：标准SKU成本与定制成本的合并计算方法

- **标准SKU毛利润**：销售价格 - 标准成本
- **定制产品毛利润**：销售价格 - 定制成本
- **总毛利润**：标准SKU毛利润总和 + 定制产品毛利润总和

## 5. 操作指南

### 5.1 定制单勾选的操作步骤

1. **打开采购订单或销售订单**
2. **添加产品明细**
3. **在明细行中找到"定制单"复选框**
4. **勾选该复选框**
5. **系统自动显示"定制成本"列**

### 5.2 定制成本录入的具体操作流程

1. **勾选"定制单"复选框后**
2. **在"定制成本"列中输入实际成本金额**
3. **系统自动计算并更新相关金额字段**
4. **保存单据**

### 5.3 相关单据的生成与流转规则

1. **采购方向**：
   - 采购订单 → 采购入库单 → 应付单 → 付款单
   - 定制成本在各单据间自动传递，确保数据一致性

2. **销售方向**：
   - 销售订单 → 销售出库单 → 应收单 → 收款单
   - 定制成本在各单据间自动传递，确保数据一致性

## 6. 业务价值与优势

### 6.1 对比传统处理方式，说明该方案如何简化低频定制产品的业务流程

**传统处理方式**：
- 为每个定制产品创建新的SKU
- 为每个定制产品创建新的BOM配方
- 维护大量低频使用的SKU和BOM，增加系统负担
- 操作流程复杂，耗时耗力

**本方案优势**：
- 无需为定制产品创建新的SKU和BOM
- 直接在订单中录入定制成本，操作简便
- 减少系统中的数据量，提高系统性能
- 简化业务流程，提高操作效率

### 6.2 阐述对用户操作效率和数据准确性的提升

**操作效率提升**：
- 减少了SKU和BOM的维护工作
- 简化了定制产品的成本录入流程
- 提高了单据处理速度

**数据准确性提升**：
- 定制成本直接与单据关联，避免了成本数据的混淆
- 确保了财务模块支付金额计算的准确性
- 提高了销售数据统计的可靠性
- 简化了毛利润计算逻辑

## 7. 流程图

### 采购方向定制成本处理流程

```mermaid
flowchart TD
    A[创建采购订单] --> B[勾选定制单复选框]
    B --> C[录入定制成本]
    C --> D[保存采购订单]
    D --> E[生成采购入库单]
    E --> F[系统继承定制成本]
    F --> G[财务模块计算应付金额]
    G --> H[生成付款单]
```

### 销售方向定制成本处理流程

```mermaid
flowchart TD
    A[创建销售订单] --> B[勾选定制单复选框]
    B --> C[录入定制成本]
    C --> D[保存销售订单]
    D --> E[生成销售出库单]
    E --> F[系统继承定制成本]
    F --> G[销售数据汇总统计]
    G --> H[计算毛利润]
```

### 定制成本数据流向

```mermaid
flowchart LR
    PO[采购订单] --> GRN[采购入库单]
    PO --> AP[应付单]
    SO[销售订单] --> SOO[销售出库单]
    SO --> AR[应收单]
    GRN --> INV[库存记录]
    SOO --> INV
    AP --> GL[总账]
    AR --> GL
    PO -.->|定制成本| GRN
    SO -.->|定制成本| SOO
    PO -.->|定制成本| AP
    SO -.->|定制成本| GL
```

## 8. 总结

通过引入定制成本列的设计，我们为低频定制产品的成本处理提供了一种灵活、高效的解决方案。该方案不仅简化了业务流程，减少了系统数据量，还确保了财务计算的准确性和数据统计的可靠性。

与传统的SKU和BOM维护方式相比，定制成本列的设计更符合低频定制产品的业务特点，为用户提供了更便捷的操作体验，同时保持了系统的整体一致性和稳定性。

这一设计思路可以为企业的成本管理提供新的视角，帮助企业更好地应对定制化生产和销售的挑战，提高企业的运营效率和竞争力。