# 会签/或签工作流测试计划

## 1. 测试目标

验证新增的会签和或签节点功能是否正常工作，包括：
1. 节点可视化显示
2. 节点属性配置
3. 与现有流程的兼容性
4. 与WorkflowCore的集成

## 2. 测试环境

- Windows操作系统
- .NET Framework 4.8
- Visual Studio开发环境
- WorkflowCore工作流引擎

## 3. 测试用例

### 3.1 会签节点测试

#### 3.1.1 节点创建测试
- 在设计器中创建会签节点
- 验证节点图标正确显示
- 验证节点默认属性设置

#### 3.1.2 节点连接测试
- 将会签节点与其他节点连接
- 验证连接线正确绘制
- 验证流程逻辑正确性

#### 3.1.3 属性配置测试
- 配置会签节点的审批人员列表
- 验证属性面板正确显示
- 验证配置信息正确保存

#### 3.1.4 审批人员编辑测试
- 点击会签节点的"审批人员"属性
- 验证弹出审批人员编辑对话框
- 验证可以添加、删除、修改审批人员
- 验证数据正确保存

### 3.2 或签节点测试

#### 3.2.1 节点创建测试
- 在设计器中创建或签节点
- 验证节点图标正确显示
- 验证节点默认属性设置

#### 3.2.2 节点连接测试
- 将或签节点与其他节点连接
- 验证连接线正确绘制
- 验证流程逻辑正确性

#### 3.2.3 属性配置测试
- 配置或签节点的审批人员列表
- 验证属性面板正确显示
- 验证配置信息正确保存

#### 3.2.4 审批人员编辑测试
- 点击或签节点的"审批人员"属性
- 验证弹出审批人员编辑对话框
- 验证可以添加、删除、修改审批人员
- 验证数据正确保存

### 3.3 流程执行测试

#### 3.3.1 会签流程测试
- 创建包含会签节点的完整流程
- 导出为WorkflowCore格式
- 在WorkflowCore中执行流程
- 验证所有审批人必须通过才能继续

#### 3.3.2 或签流程测试
- 创建包含或签节点的完整流程
- 导出为WorkflowCore格式
- 在WorkflowCore中执行流程
- 验证任一审批人通过即可继续

### 3.4 数据库持久化测试

#### 3.4.1 流程保存测试
- 设计包含会签和或签节点的流程
- 保存流程到数据库
- 验证数据正确保存到WorkflowDefinitions表

#### 3.4.2 流程加载测试
- 从数据库加载已保存的流程
- 验证流程图正确显示
- 验证会签和或签节点属性正确加载

## 4. 预期结果

1. 会签和或签节点能正常显示在设计器中
2. 节点能正确连接到其他节点
3. 节点属性能正确配置和保存
4. 导出的流程能被WorkflowCore正确执行
5. 会签节点要求所有审批人通过
6. 或签节点要求任一审批人通过
7. 流程能正确保存到数据库
8. 流程能从数据库正确加载

## 5. 测试数据

### 5.1 审批人员数据
- 用户A (ID: 1)
- 用户B (ID: 2)
- 用户C (ID: 3)

### 5.2 测试流程
1. 开始节点
2. 提交节点
3. 会签节点(用户A, 用户B, 用户C)
4. 或签节点(用户A, 用户B, 用户C)
5. 结束节点

## 6. 测试步骤

### 6.1 设计器功能测试
1. 启动工作流设计器
2. 从节点库中拖拽会签节点到画布
3. 验证节点正确显示
4. 配置节点属性
5. 连接其他节点
6. 保存流程设计

### 6.2 审批人员配置测试
1. 选择会签节点
2. 在属性面板中点击"审批人员"属性
3. 在弹出的对话框中添加多个审批人员
4. 保存并验证数据正确性

### 6.3 流程执行测试
1. 导出流程为JSON格式
2. 使用WorkflowCore加载流程
3. 启动流程实例
4. 模拟审批人操作
5. 验证流程按预期执行

### 6.4 数据库操作测试
1. 设计并保存流程到数据库
2. 关闭并重新打开设计器
3. 从数据库加载流程
4. 验证流程完整性

## 7. 验收标准

- 所有测试用例通过
- 无严重或阻塞性缺陷
- 性能满足业务要求
- 用户界面友好易用